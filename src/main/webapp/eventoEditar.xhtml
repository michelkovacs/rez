<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<ui:composition template="_template.xhtml">

	<f:metadata>
		<f:viewParam name="eventoId" value="#{eventoBean.eventoId}" />
		<f:viewAction action="#{eventoBean.carregarEventoPeloId}"
			if="#{param.eventoId != null}" />
	</f:metadata>

	<ui:define name="titulo">
				evento
	</ui:define>

	<ui:define name="conteudo">
		<h:form id="evento">
			<p:growl id="msg" />
			<p:fieldset legend="Dados do evento">
				<h:panelGrid id="pnlDadosEvento" columns="3">

					<p:outputLabel value="Titulo" for="titulo" />
					<p:inputText id="titulo" value="#{eventoBean.evento.titulo}"
						required="true" title="Título/Nome para identificação do evento">
						<f:validateLength minimum="3" />
						<f:ajax event="blur" render="messageNome" />
					</p:inputText>
					<p:message for="titulo" id="messageTitulo" />
					<p:outputLabel for="dataRealizacao" value="Data de realização:" />
					<p:calendar id="dataRealizacao"
						value="#{eventoBean.evento.dataRealizacao}" pattern="dd/MM/yyyy"
						mask="true">
						<f:convertDateTime pattern="dd/MM/yyyy" />
					</p:calendar>

					<p:spacer></p:spacer>
					<p:outputLabel for="tipoArtista" value="Tipo do artista desejado:" />
					<p:selectOneMenu id="tipoArtista"
						value="#{eventoBean.evento.tipoArtistaDesejado}" required="true"
						converter="tipoArtistaConverter"
						requiredMessage="Selecione o tipo de artista" style="width:225px">
						<f:selectItem itemLabel="Selecione o Tipo de Artista" itemValue="" />
						<f:selectItems value="#{listasCacheBean.listaTipoArtista}"
							var="tipoArtista" itemLabel="#{tipoArtista.descricao}"
							itemValue="#{tipoArtista}" />
					</p:selectOneMenu>
					<p:message for="tipoArtista" id="messageTipoArtista" />
					<p:outputLabel value="Estilos desejados:" for="estilos" />
					<p:autoComplete id="estilos" multiple="true"
						value="#{eventoBean.evento.estilosDesejados}"
						completeMethod="#{eventoBean.filtrarEstilos}" var="estilo"
						itemLabel="#{estilo.nome}" itemValue="#{estilo}"
						converter="estiloConverter" forceSelection="true">
						<p:column>
							<h:outputText value="#{estilo.nome}" />
						</p:column>
					</p:autoComplete>
					<p:spacer></p:spacer>
					<p:outputLabel value="Visível?" for="visivel" />
					<p:selectBooleanCheckbox id="visivel"
						value="#{eventoBean.evento.visivel}" />
					<p:spacer></p:spacer>
					<p:outputLabel value="Descrição:" for="descricao" />
					<p:inputTextarea id="descricao" rows="8" cols="100"
						value="#{eventoBean.evento.descricao}" />
					<p:spacer></p:spacer>
					<p:outputLabel value="Paga cachê?" for="pagaCache" />
					<p:selectBooleanCheckbox id="pagaCache"
						value="#{eventoBean.evento.pagaCache}" onLabel="SIM"
						offLabel="NÃO">
						<p:ajax listener="#{eventoBean.addMessage}" update="@all" />
					</p:selectBooleanCheckbox>

					<p:spacer></p:spacer>
					<p:outputLabel value="Cachê mínimo" for="cacheMinimo"
						rendered="#{eventoBean.evento.pagaCache}" />
					<p:inputNumber id="cacheMinimo"
						rendered="#{eventoBean.evento.pagaCache}"
						value="#{eventoBean.evento.faixaCacheMinimo}" decimalSeparator=","
						thousandSeparator="." decimalPlaces="0">
					</p:inputNumber>
					<p:spacer rendered="#{eventoBean.evento.pagaCache}"></p:spacer>
					<p:outputLabel value="Cachê máximo" for="cacheMaximo"
						rendered="#{eventoBean.evento.pagaCache}" />
					<p:inputNumber id="cacheMaximo"
						rendered="#{eventoBean.evento.pagaCache}"
						value="#{eventoBean.evento.faixaCacheMaximo}" decimalSeparator=","
						thousandSeparator="." decimalPlaces="0">
					</p:inputNumber>
					<p:spacer rendered="#{eventoBean.evento.pagaCache}"></p:spacer>
					<p:commandButton value="Gravar" action="#{eventoBean.gravar}"
						process="pnlDadosEvento" update="@form" />
				</h:panelGrid>
			</p:fieldset>
			<p:fieldset legend="Incluir foto do evento">
				<p:fileUpload fileUploadListener="#{eventoBean.handleFileUpload}"
					label="escolher arquivo" mode="advanced" dragDropSupport="false"
					update="msgUploadFoto" cancelLabel="cancelar" uploadLabel="enviar"
					sizeLimit="1000000" fileLimit="1" allowTypes="/(\.|\/)(jpe?g)$/" />

				<p:graphicImage value="#{fotoArtistaBean.fotoArtista}" title=" "
					rendered="#{eventoBean.evento.fotoUniqueId != null}">
					<f:param name="fotoArtistaUniqueId"
						value="#{eventoBean.evento.fotoUniqueId}" />
				</p:graphicImage>
			</p:fieldset>
			<p:growl id="msgUploadFoto" showDetail="true" />

		</h:form>

	</ui:define>

</ui:composition>

</html>